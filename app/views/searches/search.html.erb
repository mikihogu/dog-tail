<% if admin_signed_in? %>
<!--管理者側の検索結果-->

  <div class="container my-3">
    <div class="row">
      <div class="col mb-3">
        <h2 class="title m-3"><i class="fas fa-search"></i> "<%= @word %>" 検索結果<small>(全<%= @posts.length %>件)</small></h2>
      </div>
    </div>

    <table class="table">
      <thead>
        <tr>
          <th>投稿者</th>
          <th>施設名称</th>
          <th>所在地</th>
          <th>一言紹介文</th>
          <th></th>
          <th>更新日</th>
          <th>投稿日</th>
        </tr>
      </thead>
      <tbody>
        <% if @posts.empty? %>
          <h4>該当する投稿が見つかりません</h4>
        <% else %>
          <% @posts.each do |post| %>
            <tr>
              <td>
                <%= link_to admin_member_path(post.member) do %>
                  <%= post.member.nickname %>
                <% end %>
              </td>
              <td>
                <%= link_to admin_post_path(post) do %>
                  <%= post.name %>
                <% end %>
              </td>
              <td><%= post.prefecture %></td>
              <td><%= post.introduction %></td>
              <td>
                <span><i class="fas fa-star"></i> <%= post.favorites.count %></span>
                <span><i class="fas fa-paw"></i> <%= post.interests.count %></span>
                <span><i class="fas fa-comment-dots"></i> <%= post.comments.count %></span>
              </td>
              <td><%= l post.updated_at %></td>
              <td><%= l post.created_at %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <div>
      <%= render 'public/posts/map_index', posts: @posts %>
    </div>

  </div>


<% elsif member_signed_in? %>
<!--会員側の検索結果-->
  <div class="container my-3">
    <div class="row">
      <div class="col mb-3">
        <h2 class="title m-3"><i class="fas fa-search"></i> "<%= @word %>" 検索結果<small>(全<%= @posts.length %>件)</small></h2>
        <%= link_to '最新順(更新日)', search_path(condition: :latest, category: @category&.name, word: @word), class: 'btn btn-sm btn-outline-secondary rounded-pill' %>
        <%= link_to '古い順(投稿日)', search_path(condition: :old, category: @category&.name, word: @word), class: 'btn btn-sm btn-outline-secondary rounded-pill' %>
        <%= link_to search_path(condition: :most_favorited, category: @category&.name, word: @word), class: 'btn btn-sm btn-outline-secondary rounded-pill' do %>
          <i class="fas fa-star"></i>おすすめ順
        <% end %>
      </div>
    </div>
    <!--tab表示-->
    <div class="wrapper">
      <ul class="tab-menu">
        <li class="<%= 'active' unless @category %>"><%= link_to '全て', search_path(word: @word) %></li>
        <!--タブに表示されたカテゴリー名に紐づく投稿を一覧表示-->
        <% @categories.each do |category| %>
          <li class="<%= 'active' if category == @category %>"><%= link_to category.name, search_path(category: category.name, word: @word) %></li>
        <% end %>
      </ul>

      <div class="tab-contents">
        <div class="tab-area is-active">
          <% if @posts.empty? %>
            <div class="row">
              <div class="col-md-10 mt-5 text-center">
                <h4>該当する施設が見つかりません</h4>
              </div>
            </div>
          <% else %>
            <div class="row">
              <!--一覧-->
              <div class="col-md-9">
                <%= render 'public/posts/index', posts: @posts %>
                <div class="row justify-content-center mt-3">
                  <%= paginate @posts %>
                </div>
              </div>
              <!--Map-->
              <div class="col-md-3">
                <%= render 'public/posts/map_index', posts: @posts %>
              </div>
            </div>
          <% end %>
          <!--Top-pageリンク-->
          <p id="page-top"><a href="#">Page Top</a></p>
        </div>
      </div>
    </div>
  </div>
<% end %>
<%= javascript_pack_tag 'pagetop' %>